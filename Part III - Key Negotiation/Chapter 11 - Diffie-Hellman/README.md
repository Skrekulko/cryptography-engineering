# Chapter 11 - Diffie-Hellman

## Exercises

### Exercise 11.1

Assume $200$ people wish to communicate securely using symmetric keys, one symmetric key for each pair of people. How many symmetric keys would this system use in total?

#### Solution

```math
\frac{N(N-1)}{2}=\frac{200(200-1)}{2}=\frac{200(199)}{2}=\frac{39800}{2}=19900\textrm{ symmetric keys.}
```

### Exercise 11.2

What are the subgroups generated by $3$, $7$, and $10$ in the multiplicative group of integers modulo $p = 11$?

#### Solution

For $g=3$ (which has a order of $q=10$ as seen below):

```math
\left.\begin{matrix}
1,g,g^{2},...g^{q-1}
\\
q=11,g=3
\end{matrix}\right\}
\rightarrow
\left\{\begin{matrix}
3^{1}\equiv 3\bmod 11
\\
3^{2}\equiv 9\bmod 11
\\
3^{3}\equiv 5\bmod 11
\\
3^{4}\equiv 4\bmod 11
\\
3^{5}\equiv 12\bmod 11
\\
3^{6}\equiv 3\bmod 11
\\
3^{7}\equiv 9\bmod 11
\\
3^{8}\equiv 5\bmod 11
\\
3^{9}\equiv 4\bmod 11
\\
3^{10}\equiv 1\bmod 11
\end{matrix}\right\}
\rightarrow
\left \{ 1,3,4,5,9,12 \right \}
```

The same principle applies to the other $g$'s.

### Exercise 11.3

Why is a number $r$ a square modulo $p$, $p = 2q + 1$ and $p$ and $q$ both prime, if and only if $r^{q}=1\bmod p$.

#### Solution

```math
\begin{matrix}
\textrm{Eurler's Criterion:}
\\ 
a^{\frac{p-1}{2}}\equiv \frac{a}{p}\bmod p
\end{matrix}
\rightarrow 
\left\{\begin{matrix}
r^{q}\equiv 1\bmod p
\\ 
p=2q-1\rightarrow q=\frac{p-1}{2}
\end{matrix}\right\}
\Rightarrow
r^{\frac{p-1}{2}}\equiv \frac{r}{p}\equiv 1\bmod p\Rightarrow r\textrm{ is a quadratic residue modulo a prime.}
```

### Exercise 11.4

What problems, if any, could arise if Alice uses the same $x$ and $g^{x}$ for all her communications with Bob, and Bob uses the same $y$ and $g^{y}$ for all his communications with Alice?

#### Solution

I don't really understand the question... Were the keys compromised or not? By *all communications* is it meant that everything is encrypted with the keys (session key = shared key)? Skip.

### Exercise 11.5

Alice and Bob wish to agree on a 256-bit AES key. They are trying to decide between using 256-bit, 512-bit, or some other length DH public keys $g^{x}$ and $g^{y}$. What would be your recommendation to them?

#### Solution

According to the [SP 800-56A Rev. 3](https://csrc.nist.gov/publications/detail/sp/800-56a/rev-3/final) the recommended bit length of subgroup oder $q$ is 256 bits.
